// Generated by CoffeeScript 1.8.0
(function() {
  var Bug, EasyBug, HardBug, MediumBug;

  this.app = angular.module('BugApp', []);

  this.app.controller('GameCtrl', function($scope, $interval) {
    window.scope = $scope;
    $scope.game = {
      interval: null,
      score: 0,
      bug_rate: 2000,
      bugs: []
    };
    $scope.timer = {
      clock: 0,
      show_clock: function() {
        return Math.round($scope.timer.clock / 1000);
      },
      offset: null,
      interval: null,
      delta: function() {
        var now, tmp;
        now = Date.now();
        tmp = Date.now() - $scope.timer.offset;
        $scope.timer.offset = now;
        return tmp;
      },
      update: function() {
        return $scope.timer.clock += $scope.timer.delta();
      }
    };
    $scope.create_bug = function() {
      var bug;
      if ($scope.timer.clock / 1000 > 120) {
        bug = new HardBug;
      } else if ($scope.timer.clock / 1000 > 60) {
        bug = new MediumBug;
      } else {
        bug = new EasyBug;
      }
      bug.lat = Math.floor((Math.random() * 100) + 1);
      $scope.game.bugs.push(bug);
      return console.log("created new bug!");
    };
    $scope.pause_game = function() {
      if ($scope.timer.interval) {
        $interval.cancel($scope.timer.interval);
      }
      if ($scope.game.interval) {
        $interval.cancel($scope.game.interval);
      }
      $scope.game.interval = null;
      return $scope.timer.interval = null;
    };
    $scope.start_game = function() {
      $scope.timer.offset = Date.now();
      $scope.timer.interval = $interval(function() {
        console.log("running game time interval");
        return $scope.timer.update();
      }, 200);
      return $scope.game.interval = $interval((function() {
        var bug, _i, _len, _ref;
        _ref = $scope.game.bugs;
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          bug = _ref[_i];
          bug.move();
        }
        return $scope.create_bug();
      }), $scope.game.bug_rate);
    };
    return $scope.kill_bug = function() {};
  });

  Bug = {
    lat: 0.0,
    long: 0.0,
    move: function() {
      this.long = this.long + this.speed;
      this.lat = this.lat + Math.floor((Math.random() * this.speed) + 1);
      return console.log("moving bug to " + this.long + " long and " + this.lat + " lat");
    }
  };

  EasyBug = function() {
    var bug;
    bug = Object.create(Bug);
    bug.speed = 1;
    bug.color = 'green';
    return bug;
  };

  MediumBug = function() {
    var bug;
    bug = Object.create(Bug);
    bug.speed = 2;
    bug.color = 'orange';
    return bug;
  };

  HardBug = function() {
    var bug;
    bug = Object.create(Bug);
    bug.speed = 3;
    bug.color = 'red';
    return bug;
  };

}).call(this);
